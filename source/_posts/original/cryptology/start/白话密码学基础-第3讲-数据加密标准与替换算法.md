---
title: (白话密码学基础)第3讲-数据加密标准与替换算法
mathjax: true
copyright: true
original: true
date: 2018-04-07 11:37:47
categories: [原创,密码学,基础]
tags: [cryptology]
---
## 混淆与扩散
DES讲解之前，需要先知道，强的加密算法都应该基于如下两个特点：
1. 混淆（Confusion）：
是一种使密钥和密文之间的关系尽可能模糊的加密操作。如今实现混淆常用的一个元素就是替换：这个元素在DES和AES中都有使用。
<!-- more --> 
2. 扩散（Diffusion）：
是一种为了隐藏明文的统计属性而将一个明文符号的影像扩散到多个密文符号的加密操作。最简单的扩散元素就是位置换。它常用于DES中；而AES使用的是更高级的Mixcolum操作。
`ps:`仅仅依赖扩散的密码是不安全的，比如第一章讲到的移位密码，分分钟被破解。

`乘积密码：将若干加密操作串联起来。`目前所有的分组密码都是`乘积密码`，因为它们都是由对数据重复操作的轮组成的。
N轮乘积密码的基本原理：其中每轮都执行一次扩散和混淆操作，这样会使得相邻的密钥位之间的关系变得更加模糊：
{% asset_img 1.png  每轮都执行一次扩散和混淆操作 %}

## DES算法概述
*ps:本节看不懂的话，可以稍后看下一节的内部结构，会更详细的介绍*
DES`属于对称加密密码，它是一种使用56位密钥对64位长分组进行加密的密码`。DES对明文中每个分组的加密过程都包含16轮，且每轮的操作完全相同。如下图所示，每轮的操作都会使用不同的子密钥，并且所有子密钥$k_i$都从主密钥k中推导而来：
{% asset_img 2.png  DES的迭代结构 %}
更深入的看这个结构，会发现其中涉及到一个很多分组密码都用到的`Feistel网络`（该网络的特点是，加密解密过程几乎完全相同），
{% asset_img 3.png  DES的Feistel结构 %}
接下来根据上图来具体介绍一下到底什么是`Feistel网络`：
0. `初始置换和逆初始置换`可以去掉，以前（60年代）是为了硬件考虑，现在可以除去了，不影响结果
1. 首先要知道，图中右侧的56位密钥本质上就是一组随机数，具体生成方式可参考第二章
2. 将64位的明文x进行安位置换后，此明文会被等分成$L_0$和$R_0$两部分；
3. 然后将得到的32位的左右两部分输入到Feistel网络，
4. 而Feistel网络包含16轮操作，右半部分$R_i$将被送入函数f中，
5. f函数的输出将与32位的左半部分$L_i$进行XOR（通常用$\bigoplus$）表示，左右两部分进行交换。
6. 后面的每轮都重复这个过程，可以表示为：
$$
L_i=R_(i-1),\\\
R_i=L_(i-1)\ \bigoplus\ f(R_{i-1},k_i)\\\
其中，i=1,2,...,16
$$
7. *经过16轮后，将左右两部分再次调换一次(逆初始置换)。over*
8. 每轮中的密钥$k_i$，均来自56位的主密钥，这个过程是通过密钥编排的。

关于f函数：
1. 每轮中，f函数只加密一部分
2. 该函数可以看作是有两个输入参数$R_{i-1}$和$k_i$的`伪随机数产生器`。
3. 如果攻击者不能预测出f函数的输出，则说明此加密方法是安全的。
4. 扩散和混淆都是在f函数中实现的，需要非常小心的设计f函数

## DES的内部结构
依据上一节的图`DES的Feistel结构`来介绍每一部分

### 初始置换和逆初始置换
这两种置换都是按位置换，可以去掉它们，它们是互逆的，不影响结果。早期DES算法只允许硬件实现，为了加强硬件的破解难度而添加的，在软件实现中可以去掉，不影响，同时也加快了加解密的速度。

